import{r as h,c as f,dK as F,dL as O,d as X,dJ as J,dZ as A,dM as H,eJ as M,o as g,f as T,e as m,w as L,ea as ee,b as C,n as p,dw as n,e2 as x,j as r,es as te,g as w,F as V,eK as oe,ee as ne,dP as se,dQ as ae,eL as le,eM as re,t as z,ec as ie,e1 as ce,e5 as ue,ey as de,e3 as R,dV as ve,i as pe,x as me,d_ as Z}from"./index-5311f08a.js";import{_ as fe}from"./index-54b17d3f.js";const ge=(s,t)=>{const e={};for(const o of t)o in s&&s[o]&&(e[o]=s[o]);return e},G=s=>{if(s===void 0)return;if(typeof s=="string"&&/^\d+(%)$/.test(s))return s;const t=parseInt(s,10);return typeof t=="number"?`${t}px`:void 0},be=s=>(s*100).toFixed(0)+"%",ye=s=>s?typeof s=="string"?document.querySelector(s):s:document.body,_e=s=>{const t=h(s||"beforeLoad"),e=f(()=>t.value==="beforeLoad"),o=f(()=>t.value==="loading"),i=f(()=>t.value==="error"),l=f(()=>t.value==="loaded");return{status:t,isBeforeLoad:e,isLoading:o,isError:i,isLoaded:l,setLoadStatus:c=>{t.value=c}}},he=_e,ke=s=>{const{imageEl:t,scale:e}=F(s),o=h([0,0]);let i=!1,l,c,u=0,d=0;const b=v=>{i=!0,v.preventDefault&&v.preventDefault(),l=v.clientX,c=v.clientY,document.addEventListener("mousemove",y),document.addEventListener("mouseup",k)},y=v=>{if(i===!1)return;v.preventDefault&&v.preventDefault();const a=(v.clientX-l)/e.value+u,S=(v.clientY-c)/e.value+d;o.value=[a,S]},k=v=>{i!==!1&&(v.preventDefault&&v.preventDefault(),i=!1,u=o.value[0],d=o.value[1],document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",k))};return O(t,()=>{t.value.addEventListener("mousedown",b)}),{translate:o,resetTranslate:()=>{u=0,d=0,o.value=[u,d]}}},we=s=>{const{wrapperEl:t}=F(s),e=.1,o=.1,i=10,l=h(1),c=(d="zoomIn",b=e)=>{const y=d==="zoomIn"?b:-b;l.value+=y,l.value=Math.min(Math.max(l.value,o),i)},u=d=>{d.deltaY>0?c("zoomOut",.5):d.deltaY<0&&c("zoomIn",.5)};return O(t,()=>{t.value&&t.value.addEventListener("wheel",u)}),{scale:l,adjustZoom:c,resetScale:()=>{l.value=1}}},Ce=["src"],N=90,K=X({name:"YkImagePreview",__name:"preview",props:{visible:{type:Boolean},src:{},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},previewGroup:{type:Boolean,default:!1},popupContainer:{},unmountOnClose:{type:Boolean,default:!1},onCancel:{}},emits:["update:visible","onNext","onPrev"],setup(s,{emit:t}){const e=s,o=J("image-preview"),i=h(e.visible),l=h(0),c=h(),u=h(),{scale:d,resetScale:b,adjustZoom:y}=we(A({wrapperEl:u})),{translate:k,resetTranslate:v}=ke(A({imageEl:c,scale:d})),a=h();H(()=>a.value=ye(e.popupContainer));const S=f(()=>a.value===document.body),E=f(()=>({...S.value?{zIndex:M.nextIndex()}:{zIndex:"inherit",position:"absolute",height:"100%"}}));O(()=>e.visible,_=>{!_&&e.unmountOnClose?i.value=!1:i.value=!0,a.value&&(_?a.value.style.overflow="hidden":a.value.style.overflow="")});const $=()=>{var _;t("update:visible",!1),(_=e.onCancel)==null||_.call(e)},I=_=>{e.maskClosable&&_.target===_.currentTarget&&$()},P=()=>{l.value=l.value===0?360-N:l.value-N},D=()=>{l.value=(l.value+N)%360},q=()=>{y("zoomIn")},Q=()=>{y("zoomOut")},U=()=>{b(),v()};return(_,Y)=>{const B=fe;return g(),T(ue,{to:a.value,disabled:!a.value},[m(ce,{name:"preview-fade"},{default:L(()=>[i.value?ee((g(),C("div",{key:0,ref_key:"wrapperRef",ref:u,class:p(n(o)()),style:x(E.value)},[r("div",{class:p(n(o)("mask")),onClick:I},null,2),r("div",{class:p(n(o)("body")),style:x({transform:`scale(${n(d)}, ${n(d)})`}),onClick:I},[r("img",{ref_key:"imageRef",ref:c,src:e.src,class:p(n(o)("img")),style:x({transform:`rotate(${l.value}deg) translate(${n(k)[0]}px, ${n(k)[1]}px)`})},null,14,Ce)],6),e.closable?(g(),C("button",{key:0,class:p(n(o)("close-btn")),onClick:$},[m(n(te))],2)):w("",!0),e.previewGroup?(g(),C(V,{key:1},[r("button",{class:p(n(o)("arrow-left")),style:x({zIndex:n(M).nextIndex()}),onClick:Y[0]||(Y[0]=W=>t("onPrev"))},[m(n(oe))],6),r("button",{class:p(n(o)("arrow-right")),style:x({zIndex:n(M).nextIndex()}),onClick:Y[1]||(Y[1]=W=>t("onNext"))},[m(n(ne))],6)],64)):w("",!0),r("div",{class:p(n(o)("toolbar")),style:x({zIndex:n(M).nextIndex()})},[m(B,{placement:"top",title:"向左旋转","close-delay":0},{default:L(()=>[r("button",{class:p(n(o)("toolbar-btn")),onClick:P},[m(n(se))],2)]),_:1}),m(B,{placement:"top",title:"向右旋转","close-delay":0},{default:L(()=>[r("button",{class:p(n(o)("toolbar-btn")),onClick:D},[m(n(ae))],2)]),_:1}),m(B,{placement:"top",title:"放大","close-delay":0},{default:L(()=>[r("button",{class:p(n(o)("toolbar-btn")),onClick:q},[m(n(le))],2)]),_:1}),m(B,{placement:"top",title:"缩小","close-delay":0},{default:L(()=>[r("button",{class:p(n(o)("toolbar-btn")),onClick:Q},[m(n(re))],2)]),_:1}),m(B,{placement:"top",title:"原始比例","close-delay":0},{default:L(()=>[r("button",{class:p(n(o)("toolbar-btn")),style:{width:"50px"},onClick:U},[r("span",null,z(n(be)(n(d))),1)],2)]),_:1})],6)],6)),[[ie,e.visible]]):w("",!0)]),_:1})],8,["to","disabled"])}}});const Ie={class:"icon"},Le={key:0,class:"alt"},xe={class:"title"},Se={class:"description"},Ee=X({name:"YkImage",__name:"image",props:{src:{},width:{},height:{},title:{},alt:{},description:{},footerPosition:{default:"inner"},fit:{},preview:{type:Boolean,default:!0},popupContainer:{},onCancel:{}},setup(s){const t=s,e=J("image"),o=h(!1),{isLoaded:i,isError:l,isLoading:c,setLoadStatus:u}=he(),d=f(()=>[e(),{[`${e("with-error")}`]:l.value,[`${e("with-loading")}`]:c.value}]),b=f(()=>[e("footer",[t.footerPosition])]),y=f(()=>ge(t,["src","width","height","title","alt"])),k=f(()=>t.fit?{objectFit:t.fit}:{}),v=f(()=>({width:G(t.width),height:a.value?void 0:G(t.height)})),a=f(()=>t.title||t.description);O(()=>t.src,()=>u("loading"));const S=()=>u("loaded"),E=()=>u("error"),$=()=>{t.preview&&(o.value=!0)};return(I,P)=>(g(),C("div",{class:p(d.value),style:x(v.value)},[r("img",de({class:n(e)("img"),style:k.value},y.value,{onLoad:S,onError:E,onClick:$}),null,16),n(i)?w("",!0):(g(),C("div",{key:0,class:p(n(e)("overlay-container"))},[n(l)?R(I.$slots,"error",{key:0},()=>[r("div",{class:p(n(e)("overlay",["error"]))},[r("div",Ie,[R(I.$slots,"error-icon",{},()=>[m(n(ve))])]),t.alt?(g(),C("div",Le,z(t.alt),1)):w("",!0)],2)]):w("",!0),n(c)?R(I.$slots,"loading",{key:1},()=>[r("div",{class:p(n(e)("overlay",["loading"]))},null,2)]):w("",!0)],2)),a.value?(g(),C("div",{key:1,class:p(b.value)},[r("div",null,[r("div",xe,z(t.title),1),r("div",Se,z(t.description),1)]),r("div",null,[R(I.$slots,"extra")])],2)):w("",!0),m(K,{visible:o.value,"onUpdate:visible":P[0]||(P[0]=D=>o.value=D),src:t.src,"popup-container":t.popupContainer,onCancel:t.onCancel},null,8,["visible","src","popup-container","onCancel"])],6))}}),j=(s,t,e)=>{const o=h(s);return s!==void 0?o.value=s:o.value=t,[o,l=>{o.value=l,e==null||e(l)}]},$e=X({name:"YkImageGroup",__name:"preview-group",props:{visible:{type:Boolean},current:{default:0},srcList:{},width:{},height:{},defaultCurrent:{default:0},isRender:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},fit:{},onCancel:{}},emits:["update:visible","update:current"],setup(s,{emit:t}){const e=s,[o,i]=j(e.defaultCurrent,e.current,a=>t("update:current",a)),[l,c]=j(e.visible,!1,a=>t("update:visible",a)),u=f(()=>{var a;return(a=e.srcList)==null?void 0:a.length}),d=f(()=>{if(e.srcList&&e.srcList.length)return e.srcList[o.value]});O(()=>e.visible,a=>c(a)),O(()=>e.current,a=>i(a));const b=a=>{i(a),c(!0)},y=()=>{var a;c(!1),(a=e.onCancel)==null||a.call(e)},k=()=>{u.value&&(o.value>=u.value-1?o.value=0:o.value++)},v=()=>{u.value&&(o.value<=0?o.value=u.value-1:o.value--)};return(a,S)=>(g(),C(V,null,[e.isRender?(g(),T(n(me),{key:0},{default:L(()=>[(g(!0),C(V,null,pe(e.srcList,(E,$)=>(g(),T(n(Oe),{key:E,src:E,width:e.width,height:e.height,preview:!1,fit:e.fit,onClick:()=>b($)},null,8,["src","width","height","fit","onClick"]))),128))]),_:1})):w("",!0),m(n(Be),{visible:n(l),src:d.value,closable:e.closable,"mask-closable":e.maskClosable,"preview-group":"",onOnNext:k,onOnPrev:v,onCancel:y},null,8,["visible","src","closable","mask-closable"])],64))}}),Oe=Z(Ee),Be=Z(K),Me=Z($e);export{Me as Y,Oe as a,Be as b};
