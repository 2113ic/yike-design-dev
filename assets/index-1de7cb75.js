import{r as y,c as g,dT as q,dU as $,d as G,dS as H,e5 as F,dC as te,eM as M,o as b,f as X,i as m,w as x,dF as J,b as w,n as v,dx as o,dG as S,e as u,et as oe,g as k,F as A,eN as se,ef as ne,dX as ae,dY as le,eO as re,eP as ie,t as N,dJ as ce,dK as ue,e8 as de,ez as ve,dH as D,e1 as pe,h as me,D as fe,dL as Z}from"./index-13dc4d80.js";import{_ as ge}from"./index-ef0e9ecd.js";const be=(s,t)=>{const e={};for(const a of t)a in s&&s[a]&&(e[a]=s[a]);return e},U=s=>{if(s===void 0)return;if(typeof s=="string"&&/^\d+(%)$/.test(s))return s;const t=parseInt(s,10);return typeof t=="number"?`${t}px`:void 0},ye=s=>(s*100).toFixed(0)+"%",_e=s=>s?typeof s=="string"?document.querySelector(s):s:document.body,he={mounted(s,t){const e=new IntersectionObserver(a=>{a[0].isIntersecting?t.value(!0):t.value(!1)});e.observe(s),s._observer=e},unmounted(s){s._observer&&(s._observer.disconnect(),delete s._observer)}},Ce=s=>{const t=y(s||"beforeLoad"),e=g(()=>t.value==="beforeLoad"),a=g(()=>t.value==="loading"),n=g(()=>t.value==="error"),r=g(()=>t.value==="loaded");return{status:t,isBeforeLoad:e,isLoading:a,isError:n,isLoaded:r,setLoadStatus:c=>{t.value=c}}},ke=Ce,we=s=>{const{imageEl:t,scale:e}=q(s),a=y([0,0]);let n=!1,r,c,p=0,i=0;const f=d=>{n=!0,d.preventDefault&&d.preventDefault(),r=d.clientX,c=d.clientY,document.addEventListener("mousemove",_),document.addEventListener("mouseup",C)},_=d=>{if(n===!1)return;d.preventDefault&&d.preventDefault();const L=(d.clientX-r)/e.value+p,l=(d.clientY-c)/e.value+i;a.value=[L,l]},C=d=>{n!==!1&&(d.preventDefault&&d.preventDefault(),n=!1,p=a.value[0],i=a.value[1],document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",C))};return $(t,()=>{t.value.addEventListener("mousedown",f)}),{translate:a,resetTranslate:()=>{p=0,i=0,a.value=[p,i]}}},Ie=s=>{const{wrapperEl:t}=q(s),e=.1,a=.1,n=10,r=y(1),c=(i="zoomIn",f=e)=>{const _=i==="zoomIn"?f:-f;r.value+=_,r.value=Math.min(Math.max(r.value,a),n)},p=i=>{i.deltaY>0?c("zoomOut",.5):i.deltaY<0&&c("zoomIn",.5)};return $(t,()=>{t.value&&t.value.addEventListener("wheel",p)}),{scale:r,adjustZoom:c,resetScale:()=>{r.value=1}}},Le=["src"],V=90,K=G({name:"YkImagePreview",__name:"preview",props:{visible:{type:Boolean},src:{},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},previewGroup:{type:Boolean,default:!1},popupContainer:{},unmountOnClose:{type:Boolean,default:!1},onCancel:{}},emits:["update:visible","onNext","onPrev"],setup(s,{emit:t}){const e=s,a=t,n=H("image-preview"),r=y(e.visible),c=y(0),p=y(),i=y(),{scale:f,resetScale:_,adjustZoom:C}=Ie(F({wrapperEl:i})),{translate:d,resetTranslate:L}=we(F({imageEl:p,scale:f})),l=y();te(()=>l.value=_e(e.popupContainer));const P=g(()=>l.value===document.body),E=g(()=>({...P.value?{zIndex:M.nextIndex()}:{zIndex:"inherit",position:"absolute",height:"100%"}}));$(()=>e.visible,h=>{!h&&e.unmountOnClose?r.value=!1:r.value=!0,l.value&&(h?l.value.style.overflow="hidden":l.value.style.overflow="")});const O=()=>{var h;a("update:visible",!1),(h=e.onCancel)==null||h.call(e)},z=h=>{e.maskClosable&&h.target===h.currentTarget&&O()},I=()=>{c.value=c.value===0?360-V:c.value-V},Y=()=>{c.value=(c.value+V)%360},T=()=>{C("zoomIn")},W=()=>{C("zoomOut")},Q=()=>{_(),L()};return(h,R)=>{const B=ge;return b(),X(de,{to:l.value,disabled:!l.value},[m(ue,{name:"preview-fade"},{default:x(()=>[r.value?J((b(),w("div",{key:0,ref_key:"wrapperRef",ref:i,class:v(o(n)()),style:S(E.value)},[u("div",{class:v(o(n)("mask")),onClick:z},null,2),u("div",{class:v(o(n)("body")),style:S({transform:`scale(${o(f)}, ${o(f)})`}),onClick:z},[u("img",{ref_key:"imageRef",ref:p,src:e.src,class:v(o(n)("img")),style:S({transform:`rotate(${c.value}deg) translate(${o(d)[0]}px, ${o(d)[1]}px)`})},null,14,Le)],6),e.closable?(b(),w("button",{key:0,class:v(o(n)("close-btn")),onClick:O},[m(o(oe))],2)):k("",!0),e.previewGroup?(b(),w(A,{key:1},[u("button",{class:v(o(n)("arrow-left")),style:S({zIndex:o(M).nextIndex()}),onClick:R[0]||(R[0]=ee=>a("onPrev"))},[m(o(se))],6),u("button",{class:v(o(n)("arrow-right")),style:S({zIndex:o(M).nextIndex()}),onClick:R[1]||(R[1]=ee=>a("onNext"))},[m(o(ne))],6)],64)):k("",!0),u("div",{class:v(o(n)("toolbar")),style:S({zIndex:o(M).nextIndex()})},[m(B,{placement:"top",title:"向左旋转","close-delay":0},{default:x(()=>[u("button",{class:v(o(n)("toolbar-btn")),onClick:I},[m(o(ae))],2)]),_:1}),m(B,{placement:"top",title:"向右旋转","close-delay":0},{default:x(()=>[u("button",{class:v(o(n)("toolbar-btn")),onClick:Y},[m(o(le))],2)]),_:1}),m(B,{placement:"top",title:"放大","close-delay":0},{default:x(()=>[u("button",{class:v(o(n)("toolbar-btn")),onClick:T},[m(o(re))],2)]),_:1}),m(B,{placement:"top",title:"缩小","close-delay":0},{default:x(()=>[u("button",{class:v(o(n)("toolbar-btn")),onClick:W},[m(o(ie))],2)]),_:1}),m(B,{placement:"top",title:"原始比例","close-delay":0},{default:x(()=>[u("button",{class:v(o(n)("toolbar-btn")),style:{width:"50px"},onClick:Q},[u("span",null,N(o(ye)(o(f))),1)],2)]),_:1})],6)],6)),[[ce,e.visible]]):k("",!0)]),_:1})],8,["to","disabled"])}}});const xe=["src"],Se={class:"icon"},Ee={key:0,class:"alt"},Oe={class:"title"},$e={class:"description"},Be=G({name:"YkImage",__name:"image",props:{src:{},width:{},height:{},title:{},alt:{},description:{},footerPosition:{default:"inner"},isLazy:{type:Boolean,default:!1},fit:{},preview:{type:Boolean,default:!0},popupContainer:{},onCancel:{}},setup(s){const t=s,e=H("image"),a=y(!1),n=y(),{isLoaded:r,isError:c,isLoading:p,setLoadStatus:i}=ke(),f=g(()=>[e(),{[`${e("with-error")}`]:c.value,[`${e("with-loading")}`]:p.value}]),_=g(()=>[e("footer",[t.footerPosition])]),C=g(()=>be(t,["width","height","title","alt"])),d=g(()=>t.fit?{objectFit:t.fit}:{}),L=g(()=>({width:U(t.width),height:l.value?void 0:U(t.height)})),l=g(()=>t.title||t.description);$(()=>t.src,()=>i("loading"));const P=I=>{t.isLazy?!n.value&&I&&(n.value=t.src):n.value=t.src},E=()=>i("loaded"),O=()=>i("error"),z=()=>{t.preview&&(a.value=!0)};return(I,Y)=>J((b(),w("div",{class:v(f.value),style:S(L.value)},[u("img",ve({class:o(e)("img"),style:d.value,src:n.value},C.value,{onLoad:E,onError:O,onClick:z}),null,16,xe),o(r)?k("",!0):(b(),w("div",{key:0,class:v(o(e)("overlay-container"))},[o(c)?D(I.$slots,"error",{key:0},()=>[u("div",{class:v(o(e)("overlay",["error"]))},[u("div",Se,[D(I.$slots,"error-icon",{},()=>[m(o(pe))])]),t.alt?(b(),w("div",Ee,N(t.alt),1)):k("",!0)],2)]):k("",!0),o(p)?D(I.$slots,"loading",{key:1},()=>[u("div",{class:v(o(e)("overlay",["loading"]))},null,2)]):k("",!0)],2)),l.value?(b(),w("div",{key:1,class:v(_.value)},[u("div",null,[u("div",Oe,N(t.title),1),u("div",$e,N(t.description),1)]),u("div",null,[D(I.$slots,"extra")])],2)):k("",!0),m(K,{visible:a.value,"onUpdate:visible":Y[0]||(Y[0]=T=>a.value=T),src:t.src,"popup-container":t.popupContainer,onCancel:t.onCancel},null,8,["visible","src","popup-container","onCancel"])],6)),[[o(he),P]])}}),j=(s,t,e)=>{const a=y(s);return s!==void 0?a.value=s:a.value=t,[a,r=>{a.value=r,e==null||e(r)}]},Pe=G({name:"YkImageGroup",__name:"preview-group",props:{visible:{type:Boolean},current:{default:0},srcList:{},width:{},height:{},defaultCurrent:{default:0},isRender:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},fit:{},onCancel:{}},emits:["update:visible","update:current"],setup(s,{emit:t}){const e=s,a=t,[n,r]=j(e.defaultCurrent,e.current,l=>a("update:current",l)),[c,p]=j(e.visible,!1,l=>a("update:visible",l)),i=g(()=>{var l;return(l=e.srcList)==null?void 0:l.length}),f=g(()=>{if(e.srcList&&e.srcList.length)return e.srcList[n.value]});$(()=>e.visible,l=>p(l)),$(()=>e.current,l=>r(l));const _=l=>{r(l),p(!0)},C=()=>{var l;p(!1),(l=e.onCancel)==null||l.call(e)},d=()=>{i.value&&(n.value>=i.value-1?n.value=0:n.value++)},L=()=>{i.value&&(n.value<=0?n.value=i.value-1:n.value--)};return(l,P)=>(b(),w(A,null,[e.isRender?(b(),X(o(fe),{key:0},{default:x(()=>[(b(!0),w(A,null,me(e.srcList,(E,O)=>(b(),X(o(ze),{key:E,src:E,width:e.width,height:e.height,preview:!1,fit:e.fit,onClick:()=>_(O)},null,8,["src","width","height","fit","onClick"]))),128))]),_:1})):k("",!0),m(o(Ye),{visible:o(c),src:f.value,closable:e.closable,"mask-closable":e.maskClosable,"preview-group":"",onOnNext:d,onOnPrev:L,onCancel:C},null,8,["visible","src","closable","mask-closable"])],64))}}),ze=Z(Be),Ye=Z(K),De=Z(Pe);export{De as Y,ze as a,Ye as b};
