import{d as E,a2 as L,r as b,a3 as O,c as g,T as U,a4 as K,o as P,f as W,w as C,W as Z,e as j,n as q,Z as a,i as w,m as B,$ as G,ao as J,z as Q}from"./index-d235c6f2.js";import{Y as X}from"./index-90c4f8c5.js";import{I as ee}from"./index-37f9f761.js";import{I as te}from"./index-9c463fc8.js";import{u as ne}from"./use-form-item-bd41a5ee.js";const S=(s,u,l)=>{if(Number.isInteger(s)&&Number.isInteger(u)){const t=s+u;if(l===0)return t}const r=s.toString().split(".")[1]??"",i=u.toString().split(".")[1]??"",n=10**Math.max(r.length??0,i.length??0);return(s*n+u*n)/n},ae=(s,u)=>{if(!s||Number.isNaN(s))return 0;const l=s.toString().split("."),r=l[0];let i=l[1]??"";return i.length>u?(i=i.slice(0,u),+`${r}.${i}`):s},se=/[-]?(\d*\.\d+|\d+\.\d|\d+)/,oe=250,ue=60,le=E({name:"YkInputNumber",__name:"input-number",props:{modelValue:{},max:{default:1/0},min:{default:-1/0},step:{default:1},precision:{default:0},size:{default:"l"},disabled:{type:Boolean,default:!1},message:{},controls:{type:Boolean,default:!0},formatter:{type:Function,default:s=>s}},emits:["update:modelValue","increase","decrease"],setup(s,{emit:u}){const l=s,r=L("input-number"),i=b(!1),c=b(!1),n=O(l),t=b(0),D=b(),{disabled:F,size:R}=n,{mergedSize:v,mergedDisabled:_}=ne({disabled:F,size:R});let m;const d=g(()=>{let e=n.precision.value;return(!Number.isInteger(e)||e>20)&&(e=0),e}),M=()=>l.max===1/0&&l.min===-1/0?0:l.min;let I,y;const $=e=>{if(l.disabled)return;const o=e===1?x:z;window.addEventListener("mouseup",f),I=window.setTimeout(()=>{y=window.setInterval(()=>{o()},ue)},oe)},f=()=>{I&&clearTimeout(I),y&&clearInterval(y),window.removeEventListener("mouseup",f)},N=g(()=>t.value<=n.min.value),V=g(()=>t.value>=n.max.value);U(()=>{var e;t.value=((e=n.modelValue)==null?void 0:e.value)??M()});const x=()=>{if(V.value){f();return}m=S(t.value,n.step.value,d.value),t.value=m>=n.max.value?n.max.value:m,p(),u("increase")},z=()=>{if(N.value){f();return}m=S(t.value,-n.step.value,d.value),t.value=m<=n.min.value?n.min.value:m,p(),u("decrease")},T=e=>{e.key==="ArrowUp"&&x(),e.key==="ArrowDown"&&z()},Y=()=>{p()},A=()=>{c.value=!0},H=e=>{var o;t.value=e?Number((e.match(se)??["0"])[0]):0,d.value===0?t.value=Math.trunc(t.value):t.value=ae(t.value,d.value),V.value&&(t.value=n.max.value),N.value&&(t.value=n.min.value),p(),c.value=!1,(o=D.value)==null||o.setValue(h.value)},p=()=>{u("update:modelValue",t.value)},h=g(()=>{const e=t.value.toFixed(d.value);return c.value?e:n.formatter.value(e)??e});return K(()=>l.modelValue,e=>{t.value=e??M()}),(e,o)=>(P(),W(a(X),J({ref_key:"inputRef",ref:D,"model-value":h.value,disabled:a(_),size:a(v),class:a(r)()},e.$attrs,{onFocus:A,onChange:Y,onBlur:H,onHoverin:o[2]||(o[2]=k=>i.value=!0),onHoverout:o[3]||(o[3]=k=>i.value=!1),onKeydown:T}),{suffix:C(()=>[Z(j("div",{class:q([a(r)("buttons"),a(r)([a(v)])])},[w(a(B),{disabled:V.value,size:a(v),type:"secondary",onClick:x,onMousedown:o[0]||(o[0]=k=>$(1))},{default:C(()=>[w(a(ee))]),_:1},8,["disabled","size"]),w(a(B),{disabled:N.value,size:a(v),type:"secondary",onClick:z,onMousedown:o[1]||(o[1]=k=>$(0))},{default:C(()=>[w(a(te))]),_:1},8,["disabled","size"])],2),[[G,e.controls&&!a(_)&&i.value]])]),_:1},16,["model-value","disabled","size","class"]))}}),ie=Q(le),fe=ie;export{fe as _};
