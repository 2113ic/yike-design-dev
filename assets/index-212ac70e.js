import{r as k,c as f,dE as j,dF as $,d as G,dD as q,dT as A,dG as Q,eD as R,o as g,f as T,e as m,w as L,e4 as ee,b as _,n as p,dq as n,dY as x,j as r,em as te,g as C,F as X,eE as oe,ei as ne,dJ as se,dK as ae,eF as le,eG as re,t as D,e6 as ie,dX as ce,d$ as ue,es as de,dZ as z,dP as ve,i as pe,v as me,dU as Z}from"./index-79e930ed.js";import{_ as fe}from"./index-f659bb4b.js";const ge=(s,t)=>{const e={};for(const o of t)o in s&&s[o]&&(e[o]=s[o]);return e},V=s=>{if(s===void 0)return;if(typeof s=="string"&&/^\d+(%)$/.test(s))return s;const t=parseInt(s,10);return typeof t=="number"?`${t}px`:void 0},be=s=>(s*100).toFixed(0)+"%",ye=s=>s?typeof s=="string"?document.querySelector(s):s:document.body,he=s=>{const t=k(s||"beforeLoad"),e=f(()=>t.value==="beforeLoad"),o=f(()=>t.value==="loading"),i=f(()=>t.value==="error"),l=f(()=>t.value==="loaded");return{status:t,isBeforeLoad:e,isLoading:o,isError:i,isLoaded:l,setLoadStatus:c=>{t.value=c}}},ke=he,we=s=>{const{imageEl:t,scale:e}=j(s),o=k([0,0]);let i=!1,l,c,u=0,d=0;const b=v=>{i=!0,v.preventDefault&&v.preventDefault(),l=v.clientX,c=v.clientY,document.addEventListener("mousemove",y),document.addEventListener("mouseup",w)},y=v=>{if(i===!1)return;v.preventDefault&&v.preventDefault();const a=(v.clientX-l)/e.value+u,S=(v.clientY-c)/e.value+d;o.value=[a,S]},w=v=>{i!==!1&&(v.preventDefault&&v.preventDefault(),i=!1,u=o.value[0],d=o.value[1],document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",w))};return $(t,()=>{t.value.addEventListener("mousedown",b)}),{translate:o,resetTranslate:()=>{u=0,d=0,o.value=[u,d]}}},Ce=s=>{const{wrapperEl:t}=j(s),e=.1,o=.1,i=10,l=k(1),c=(d="zoomIn",b=e)=>{const y=d==="zoomIn"?b:-b;l.value+=y,l.value=Math.min(Math.max(l.value,o),i)},u=d=>{d.deltaY>0?c("zoomOut",.5):d.deltaY<0&&c("zoomIn",.5)};return $(t,()=>{t.value&&t.value.addEventListener("wheel",u)}),{scale:l,adjustZoom:c,resetScale:()=>{l.value=1}}},_e=["src"],N=90,U=G({name:"YkImagePreview",__name:"preview",props:{visible:{type:Boolean},src:{},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},previewGroup:{type:Boolean,default:!1},popupContainer:{},unmountOnClose:{type:Boolean,default:!1},onCancel:{}},emits:["update:visible","onNext","onPrev"],setup(s,{emit:t}){const e=s,o=q("image-preview"),i=k(e.visible),l=k(0),c=k(),u=k(),{scale:d,resetScale:b,adjustZoom:y}=Ce(A({wrapperEl:u})),{translate:w,resetTranslate:v}=we(A({imageEl:c,scale:d})),a=k();Q(()=>a.value=ye(e.popupContainer));const S=f(()=>a.value===document.body),E=f(()=>({...S.value?{zIndex:R.nextIndex()}:{zIndex:"inherit",position:"absolute",height:"100%"}}));$(()=>e.visible,h=>{!h&&e.unmountOnClose?i.value=!1:i.value=!0,a.value&&(h?a.value.style.overflow="hidden":a.value.style.overflow="")});const O=()=>{var h;t("update:visible",!1),(h=e.onCancel)==null||h.call(e)},I=h=>{e.maskClosable&&h.target===h.currentTarget&&O()},P=()=>{l.value=l.value===0?360-N:l.value-N},M=()=>{l.value=(l.value+N)%360},J=()=>{y("zoomIn")},K=()=>{y("zoomOut")},W=()=>{b(),v()};return(h,Y)=>{const B=fe;return g(),T(ue,{to:a.value,disabled:!a.value},[m(ce,{name:"preview-fade"},{default:L(()=>[i.value?ee((g(),_("div",{key:0,ref_key:"wrapperRef",ref:u,class:p(n(o)()),style:x(E.value)},[r("div",{class:p(n(o)("mask")),onClick:I},null,2),r("div",{class:p(n(o)("body")),style:x({transform:`scale(${n(d)}, ${n(d)})`}),onClick:I},[r("img",{ref_key:"imageRef",ref:c,src:e.src,class:p(n(o)("img")),style:x({transform:`rotate(${l.value}deg) translate(${n(w)[0]}px, ${n(w)[1]}px)`})},null,14,_e)],6),e.closable?(g(),_("button",{key:0,class:p(n(o)("close-btn")),onClick:O},[m(n(te))],2)):C("",!0),e.previewGroup?(g(),_(X,{key:1},[r("button",{class:p(n(o)("arrow-left")),style:x({zIndex:n(R).nextIndex()}),onClick:Y[0]||(Y[0]=H=>t("onPrev"))},[m(n(oe))],6),r("button",{class:p(n(o)("arrow-right")),style:x({zIndex:n(R).nextIndex()}),onClick:Y[1]||(Y[1]=H=>t("onNext"))},[m(n(ne))],6)],64)):C("",!0),r("div",{class:p(n(o)("toolbar")),style:x({zIndex:n(R).nextIndex()})},[m(B,{placement:"top",title:"向左旋转","close-delay":0},{default:L(()=>[r("button",{class:p(n(o)("toolbar-btn")),onClick:P},[m(n(se))],2)]),_:1}),m(B,{placement:"top",title:"向右旋转","close-delay":0},{default:L(()=>[r("button",{class:p(n(o)("toolbar-btn")),onClick:M},[m(n(ae))],2)]),_:1}),m(B,{placement:"top",title:"放大","close-delay":0},{default:L(()=>[r("button",{class:p(n(o)("toolbar-btn")),onClick:J},[m(n(le))],2)]),_:1}),m(B,{placement:"top",title:"缩小","close-delay":0},{default:L(()=>[r("button",{class:p(n(o)("toolbar-btn")),onClick:K},[m(n(re))],2)]),_:1}),m(B,{placement:"top",title:"原始比例","close-delay":0},{default:L(()=>[r("button",{class:p(n(o)("toolbar-btn")),style:{width:"50px"},onClick:W},[r("span",null,D(n(be)(n(d))),1)],2)]),_:1})],6)],6)),[[ie,e.visible]]):C("",!0)]),_:1})],8,["to","disabled"])}}});const Ie={class:"icon"},Le={key:0,class:"alt"},xe={class:"title"},Se={class:"description"},Ee=G({name:"YkImage",__name:"image",props:{src:{},width:{},height:{},title:{},alt:{},description:{},footerPosition:{default:"inner"},fit:{},preview:{type:Boolean,default:!0},popupContainer:{},onCancel:{}},setup(s){const t=s,e=q("image"),o=k(!1),{isLoaded:i,isError:l,isLoading:c,setLoadStatus:u}=ke(),d=f(()=>[e(),{[`${e("with-error")}`]:l.value,[`${e("with-loading")}`]:c.value}]),b=f(()=>[e("footer",[t.footerPosition])]),y=f(()=>ge(t,["src","width","height","title","alt"])),w=f(()=>t.fit?{objectFit:t.fit}:{}),v=f(()=>({width:V(t.width),height:a.value?void 0:V(t.height)})),a=f(()=>t.title||t.description);$(()=>t.src,()=>u("loading"));const S=()=>u("loaded"),E=()=>u("error"),O=()=>{t.preview&&(o.value=!0)};return(I,P)=>(g(),_("div",{class:p(d.value),style:x(v.value)},[r("img",de({class:n(e)("img"),style:w.value},y.value,{onLoad:S,onError:E,onClick:O}),null,16),n(i)?C("",!0):(g(),_("div",{key:0,class:p(n(e)("overlay-container"))},[n(l)?z(I.$slots,"error",{key:0},()=>[r("div",{class:p(n(e)("overlay",["error"]))},[r("div",Ie,[z(I.$slots,"error-icon",{},()=>[m(n(ve))])]),t.alt?(g(),_("div",Le,D(t.alt),1)):C("",!0)],2)]):C("",!0),n(c)?z(I.$slots,"loading",{key:1},()=>[r("div",{class:p(n(e)("overlay",["loading"]))},null,2)]):C("",!0)],2)),a.value?(g(),_("div",{key:1,class:p(b.value)},[r("div",null,[r("div",xe,D(t.title),1),r("div",Se,D(t.description),1)]),r("div",null,[z(I.$slots,"extra")])],2)):C("",!0),m(U,{visible:o.value,"onUpdate:visible":P[0]||(P[0]=M=>o.value=M),src:t.src,"popup-container":t.popupContainer,onCancel:t.onCancel},null,8,["visible","src","popup-container","onCancel"])],6))}}),F=(s,t,e)=>{const o=k(s);return s!==void 0?o.value=s:o.value=t,[o,l=>{o.value=l,e==null||e(l)}]},Oe=G({name:"YkImageGroup",__name:"preview-group",props:{visible:{type:Boolean},current:{default:0},srcList:{},width:{},height:{},defaultCurrent:{default:0},isRender:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},fit:{},onCancel:{}},emits:["update:visible","update:current"],setup(s,{emit:t}){const e=s,[o,i]=F(e.defaultCurrent,e.current,a=>t("update:current",a)),[l,c]=F(e.visible,!1,a=>t("update:visible",a)),u=f(()=>{var a;return(a=e.srcList)==null?void 0:a.length}),d=f(()=>{if(e.srcList&&e.srcList.length)return e.srcList[o.value]});$(()=>e.visible,a=>c(a)),$(()=>e.current,a=>i(a));const b=a=>{i(a),c(!0)},y=()=>{var a;c(!1),(a=e.onCancel)==null||a.call(e)},w=()=>{u.value&&(o.value>=u.value-1?o.value=0:o.value++)},v=()=>{u.value&&(o.value<=0?o.value=u.value-1:o.value--)};return(a,S)=>(g(),_(X,null,[e.isRender?(g(),T(n(me),{key:0},{default:L(()=>[(g(!0),_(X,null,pe(e.srcList,(E,O)=>(g(),T(n($e),{key:E,src:E,width:e.width,height:e.height,preview:!1,fit:e.fit,onClick:()=>b(O)},null,8,["src","width","height","fit","onClick"]))),128))]),_:1})):C("",!0),m(n(Be),{visible:n(l),src:d.value,closable:e.closable,"mask-closable":e.maskClosable,"preview-group":"",onOnNext:w,onOnPrev:v,onCancel:y},null,8,["visible","src","closable","mask-closable"])],64))}}),$e=Z(Ee),Be=Z(U),Re=Z(Oe);export{Re as Y,$e as a,Be as b};
