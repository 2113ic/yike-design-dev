import{r as h,c as m,a3 as q,a4 as $,d as Z,a2 as U,a7 as F,T as ee,az as R,o as g,f as X,i as f,w as x,W as H,b as w,n as v,Z as s,y as S,e as c,A as te,g as C,F as A,t as T,$ as oe,a0 as se,aa as ne,ao as ae,X as M,h as le,x as re,z as G}from"./index-9ece1d16.js";import{Y as B}from"./index-6ad893d8.js";import{I as ie}from"./index-6dc6a83b.js";import{_ as ce}from"./index-1405c767.js";import{a as ue,b as de,c as ve,d as pe,I as fe}from"./index-05f00c3f.js";const me=(n,t)=>{const e={};for(const o of t)o in n&&n[o]&&(e[o]=n[o]);return e},W=n=>{if(n===void 0)return;if(typeof n=="string"&&/^\d+(%)$/.test(n))return n;const t=parseInt(n,10);return typeof t=="number"?`${t}px`:void 0},ge=n=>(n*100).toFixed(0)+"%",be=n=>n?typeof n=="string"?document.querySelector(n):n:document.body,ye={mounted(n,t){const e=new IntersectionObserver(o=>{o[0].isIntersecting?t.value(!0):t.value(!1)});e.observe(n),n._observer=e},unmounted(n){n._observer&&(n._observer.disconnect(),delete n._observer)}},he=n=>{const t=h(n||"beforeLoad"),e=m(()=>t.value==="beforeLoad"),o=m(()=>t.value==="loading"),r=m(()=>t.value==="error"),l=m(()=>t.value==="loaded");return{status:t,isBeforeLoad:e,isLoading:o,isError:r,isLoaded:l,setLoadStatus:u=>{t.value=u}}},_e=he,ke=n=>{const{imageEl:t,scale:e}=q(n),o=h([0,0]);let r=!1,l,u,p=0,i=0;const b=d=>{r=!0,d.preventDefault&&d.preventDefault(),l=d.clientX,u=d.clientY,document.addEventListener("mousemove",y),document.addEventListener("mouseup",k)},y=d=>{if(r===!1)return;d.preventDefault&&d.preventDefault();const a=(d.clientX-l)/e.value+p,L=(d.clientY-u)/e.value+i;o.value=[a,L]},k=d=>{r!==!1&&(d.preventDefault&&d.preventDefault(),r=!1,p=o.value[0],i=o.value[1],document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",k))};return $(t,()=>{t.value.addEventListener("mousedown",b)}),{translate:o,resetTranslate:()=>{p=0,i=0,o.value=[p,i]}}},Ce=n=>{const{wrapperEl:t}=q(n),e=.1,o=.1,r=10,l=h(1),u=(i="zoomIn",b=e)=>{const y=i==="zoomIn"?b:-b;l.value+=y,l.value=Math.min(Math.max(l.value,o),r)},p=i=>{i.deltaY>0?u("zoomOut",.5):i.deltaY<0&&u("zoomIn",.5)};return $(t,()=>{t.value&&t.value.addEventListener("wheel",p)}),{scale:l,adjustZoom:u,resetScale:()=>{l.value=1}}},we=["src"],V=90,J=Z({name:"YkImagePreview",__name:"preview",props:{visible:{type:Boolean},src:{},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},previewGroup:{type:Boolean,default:!1},popupContainer:{},unmountOnClose:{type:Boolean,default:!1},onCancel:{}},emits:["update:visible","onNext","onPrev"],setup(n,{emit:t}){const e=n,o=U("image-preview"),r=h(e.visible),l=h(0),u=h(),p=h(),{scale:i,resetScale:b,adjustZoom:y}=Ce(F({wrapperEl:p})),{translate:k,resetTranslate:d}=ke(F({imageEl:u,scale:i})),a=h();ee(()=>a.value=be(e.popupContainer));const L=m(()=>a.value===document.body),E=m(()=>({...L.value?{zIndex:R.nextIndex()}:{zIndex:"inherit",position:"absolute",height:"100%"}}));$(()=>e.visible,_=>{!_&&e.unmountOnClose?r.value=!1:r.value=!0,a.value&&(_?a.value.style.overflow="hidden":a.value.style.overflow="")});const O=()=>{var _;t("update:visible",!1),(_=e.onCancel)==null||_.call(e)},z=_=>{e.maskClosable&&_.target===_.currentTarget&&O()},D=()=>{l.value=l.value===0?360-V:l.value-V},I=()=>{l.value=(l.value+V)%360},Y=()=>{y("zoomIn")},N=()=>{y("zoomOut")},K=()=>{b(),d()};return(_,P)=>(g(),X(ne,{to:a.value,disabled:!a.value},[f(se,{name:"preview-fade"},{default:x(()=>[r.value?H((g(),w("div",{key:0,ref_key:"wrapperRef",ref:p,class:v(s(o)()),style:S(E.value)},[c("div",{class:v(s(o)("mask")),onClick:z},null,2),c("div",{class:v(s(o)("body")),style:S({transform:`scale(${s(i)}, ${s(i)})`}),onClick:z},[c("img",{ref_key:"imageRef",ref:u,src:e.src,class:v(s(o)("img")),style:S({transform:`rotate(${l.value}deg) translate(${s(k)[0]}px, ${s(k)[1]}px)`})},null,14,we)],6),e.closable?(g(),w("button",{key:0,class:v(s(o)("close-btn")),onClick:O},[f(s(te))],2)):C("",!0),e.previewGroup?(g(),w(A,{key:1},[c("button",{class:v(s(o)("arrow-left")),style:S({zIndex:s(R).nextIndex()}),onClick:P[0]||(P[0]=Q=>t("onPrev"))},[f(s(ie))],6),c("button",{class:v(s(o)("arrow-right")),style:S({zIndex:s(R).nextIndex()}),onClick:P[1]||(P[1]=Q=>t("onNext"))},[f(s(ce))],6)],64)):C("",!0),c("div",{class:v(s(o)("toolbar")),style:S({zIndex:s(R).nextIndex()})},[f(s(B),{placement:"top",title:"向左旋转","close-delay":0},{default:x(()=>[c("button",{class:v(s(o)("toolbar-btn")),onClick:D},[f(s(ue))],2)]),_:1}),f(s(B),{placement:"top",title:"向右旋转","close-delay":0},{default:x(()=>[c("button",{class:v(s(o)("toolbar-btn")),onClick:I},[f(s(de))],2)]),_:1}),f(s(B),{placement:"top",title:"放大","close-delay":0},{default:x(()=>[c("button",{class:v(s(o)("toolbar-btn")),onClick:Y},[f(s(ve))],2)]),_:1}),f(s(B),{placement:"top",title:"缩小","close-delay":0},{default:x(()=>[c("button",{class:v(s(o)("toolbar-btn")),onClick:N},[f(s(pe))],2)]),_:1}),f(s(B),{placement:"top",title:"原始比例","close-delay":0},{default:x(()=>[c("button",{class:v(s(o)("toolbar-btn")),style:{width:"50px"},onClick:K},[c("span",null,T(s(ge)(s(i))),1)],2)]),_:1})],6)],6)),[[oe,e.visible]]):C("",!0)]),_:1})],8,["to","disabled"]))}}),Ie=["src"],Le={class:"icon"},xe={key:0,class:"alt"},Se={class:"title"},Ee={class:"description"},Oe=Z({name:"YkImage",__name:"image",props:{src:{},width:{},height:{},title:{},alt:{},description:{},footerPosition:{default:"inner"},isLazy:{type:Boolean,default:!1},fit:{},preview:{type:Boolean,default:!0},popupContainer:{},onCancel:{}},setup(n){const t=n,e=U("image"),o=h(!1),r=h(),{isLoaded:l,isError:u,isLoading:p,setLoadStatus:i}=_e(),b=m(()=>[e(),{[`${e("with-error")}`]:u.value,[`${e("with-loading")}`]:p.value}]),y=m(()=>[e("footer",[t.footerPosition])]),k=m(()=>me(t,["width","height","title","alt"])),d=m(()=>t.fit?{objectFit:t.fit}:{}),a=m(()=>({width:W(t.width),height:L.value?void 0:W(t.height)})),L=m(()=>t.title||t.description);$(()=>t.src,()=>i("loading"));const E=I=>{t.isLazy?!r.value&&I&&(r.value=t.src):r.value=t.src},O=()=>i("loaded"),z=()=>i("error"),D=()=>{t.preview&&(o.value=!0)};return(I,Y)=>H((g(),w("div",{class:v(b.value),style:S(a.value)},[c("img",ae({class:s(e)("img"),style:d.value,src:r.value},k.value,{onLoad:O,onError:z,onClick:D}),null,16,Ie),s(l)?C("",!0):(g(),w("div",{key:0,class:v(s(e)("overlay-container"))},[s(u)?M(I.$slots,"error",{key:0},()=>[c("div",{class:v(s(e)("overlay",["error"]))},[c("div",Le,[M(I.$slots,"error-icon",{},()=>[f(s(fe))])]),t.alt?(g(),w("div",xe,T(t.alt),1)):C("",!0)],2)]):C("",!0),s(p)?M(I.$slots,"loading",{key:1},()=>[c("div",{class:v(s(e)("overlay",["loading"]))},null,2)]):C("",!0)],2)),L.value?(g(),w("div",{key:1,class:v(y.value)},[c("div",null,[c("div",Se,T(t.title),1),c("div",Ee,T(t.description),1)]),c("div",null,[M(I.$slots,"extra")])],2)):C("",!0),f(J,{visible:o.value,"onUpdate:visible":Y[0]||(Y[0]=N=>o.value=N),src:t.src,"popup-container":t.popupContainer,onCancel:t.onCancel},null,8,["visible","src","popup-container","onCancel"])],6)),[[s(ye),E]])}}),j=(n,t,e)=>{const o=h(n);return n!==void 0?o.value=n:o.value=t,[o,l=>{o.value=l,e==null||e(l)}]},$e=Z({name:"YkImageGroup",__name:"preview-group",props:{visible:{type:Boolean},current:{default:0},srcList:{},width:{},height:{},defaultCurrent:{default:0},isRender:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},fit:{},onCancel:{}},emits:["update:visible","update:current"],setup(n,{emit:t}){const e=n,[o,r]=j(e.defaultCurrent,e.current,a=>t("update:current",a)),[l,u]=j(e.visible,!1,a=>t("update:visible",a)),p=m(()=>{var a;return(a=e.srcList)==null?void 0:a.length}),i=m(()=>{if(e.srcList&&e.srcList.length)return e.srcList[o.value]});$(()=>e.visible,a=>u(a)),$(()=>e.current,a=>r(a));const b=a=>{r(a),u(!0)},y=()=>{var a;u(!1),(a=e.onCancel)==null||a.call(e)},k=()=>{p.value&&(o.value>=p.value-1?o.value=0:o.value++)},d=()=>{p.value&&(o.value<=0?o.value=p.value-1:o.value--)};return(a,L)=>(g(),w(A,null,[e.isRender?(g(),X(s(re),{key:0},{default:x(()=>[(g(!0),w(A,null,le(e.srcList,(E,O)=>(g(),X(s(Be),{key:E,src:E,width:e.width,height:e.height,preview:!1,fit:e.fit,onClick:()=>b(O)},null,8,["src","width","height","fit","onClick"]))),128))]),_:1})):C("",!0),f(s(ze),{visible:s(l),src:i.value,closable:e.closable,"mask-closable":e.maskClosable,"preview-group":"",onOnNext:k,onOnPrev:d,onCancel:y},null,8,["visible","src","closable","mask-closable"])],64))}}),Be=G(Oe),ze=G(J),De=G($e);export{De as Y,Be as a,ze as b};
