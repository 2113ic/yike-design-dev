import{d as H,dS as L,r as b,dT as E,c as g,dC as O,dU as J,o as K,f as P,w as k,dF as j,e as q,n as G,dx as s,i as w,s as B,eU as Q,eT as W,dJ as X,ez as Z,dL as ee}from"./index-da6cc329.js";import{Y as te}from"./index-033b3b07.js";import{u as ne}from"./use-form-item-864b27a1.js";const $=(a,u,l)=>{if(Number.isInteger(a)&&Number.isInteger(u)){const t=a+u;if(l===0)return t}const r=a.toString().split(".")[1]??"",i=u.toString().split(".")[1]??"",n=10**Math.max(r.length??0,i.length??0);return(a*n+u*n)/n},se=(a,u)=>{if(!a||Number.isNaN(a))return 0;const l=a.toString().split("."),r=l[0];let i=l[1]??"";return i.length>u?(i=i.slice(0,u),+`${r}.${i}`):a},ae=/[-]?(\d*\.\d+|\d+\.\d|\d+)/,oe=250,ue=60,le=H({name:"YkInputNumber",__name:"input-number",props:{modelValue:{},max:{default:1/0},min:{default:-1/0},step:{default:1},precision:{default:0},size:{default:"l"},disabled:{type:Boolean,default:!1},message:{},controls:{type:Boolean,default:!0},formatter:{type:Function,default:a=>a}},emits:["update:modelValue","increase","decrease"],setup(a,{emit:u}){const l=a,r=L("input-number"),i=b(!1),m=b(!1),n=E(l),t=b(0),D=b(),{disabled:F,size:R}=n,{mergedSize:v,mergedDisabled:_}=ne({disabled:F,size:R});let d;const c=g(()=>{let e=n.precision.value;return(!Number.isInteger(e)||e>20)&&(e=0),e}),M=()=>l.max===1/0&&l.min===-1/0?0:l.min;let I,y;const S=e=>{if(l.disabled)return;const o=e===1?V:z;window.addEventListener("mouseup",f),I=window.setTimeout(()=>{y=window.setInterval(()=>{o()},ue)},oe)},f=()=>{I&&clearTimeout(I),y&&clearInterval(y),window.removeEventListener("mouseup",f)},x=g(()=>t.value<=n.min.value),N=g(()=>t.value>=n.max.value);O(()=>{var e;t.value=((e=n.modelValue)==null?void 0:e.value)??M()});const V=()=>{if(N.value){f();return}d=$(t.value,n.step.value,c.value),t.value=d>=n.max.value?n.max.value:d,p(),u("increase")},z=()=>{if(x.value){f();return}d=$(t.value,-n.step.value,c.value),t.value=d<=n.min.value?n.min.value:d,p(),u("decrease")},T=e=>{e.key==="ArrowUp"&&V(),e.key==="ArrowDown"&&z()},U=()=>{p()},Y=()=>{m.value=!0},A=e=>{var o;t.value=e?Number((e.match(ae)??["0"])[0]):0,c.value===0?t.value=Math.trunc(t.value):t.value=se(t.value,c.value),N.value&&(t.value=n.max.value),x.value&&(t.value=n.min.value),p(),m.value=!1,(o=D.value)==null||o.setValue(h.value)},p=()=>{u("update:modelValue",t.value)},h=g(()=>{const e=t.value.toFixed(c.value);return m.value?e:n.formatter.value(e)??e});return J(()=>l.modelValue,e=>{t.value=e??M()}),(e,o)=>(K(),P(s(te),Z({ref_key:"inputRef",ref:D,"model-value":h.value,disabled:s(_),size:s(v),class:s(r)()},e.$attrs,{onFocus:Y,onChange:U,onBlur:A,onHoverin:o[2]||(o[2]=C=>i.value=!0),onHoverout:o[3]||(o[3]=C=>i.value=!1),onKeydown:T}),{suffix:k(()=>[j(q("div",{class:G([s(r)("buttons"),s(r)([s(v)])])},[w(s(B),{disabled:N.value,size:s(v),type:"secondary",onClick:V,onMousedown:o[0]||(o[0]=C=>S(1))},{default:k(()=>[w(s(Q))]),_:1},8,["disabled","size"]),w(s(B),{disabled:x.value,size:s(v),type:"secondary",onClick:z,onMousedown:o[1]||(o[1]=C=>S(0))},{default:k(()=>[w(s(W))]),_:1},8,["disabled","size"])],2),[[X,e.controls&&!s(_)&&i.value]])]),_:1},16,["model-value","disabled","size","class"]))}}),ie=ee(le),me=ie;export{me as _};
