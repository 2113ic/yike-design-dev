import{d as L,dS as E,r as g,dT as O,c as w,dC as J,dU as K,o as P,f as j,w as D,dF as q,e as G,n as Q,dx as s,i as I,s as $,eU as W,eT as X,dJ as Z,ez as ee,dL as te}from"./index-2e6203f3.js";import{Y as ne}from"./index-c922d048.js";import{u as se}from"./use-form-item-95286ffe.js";const F=(a,i,u)=>{if(Number.isInteger(a)&&Number.isInteger(i)){const n=a+i;if(u===0)return n}const r=a.toString().split(".")[1]??"",l=i.toString().split(".")[1]??"",d=10**Math.max(r.length??0,l.length??0);return(a*d+i*d)/d},ae=(a,i)=>{if(!a||Number.isNaN(a))return 0;const u=a.toString().split("."),r=u[0];let l=u[1]??"";return l.length>i?(l=l.slice(0,i),+`${r}.${l}`):a},oe=/[-]?(\d*\.\d+|\d+\.\d|\d+)/,ue=250,le=60,ie=L({name:"YkInputNumber",__name:"input-number",props:{modelValue:{},max:{default:1/0},min:{default:-1/0},step:{default:1},precision:{default:0},size:{default:"l"},disabled:{type:Boolean,default:!1},message:{},controls:{type:Boolean,default:!0},formatter:{type:Function,default:a=>a}},emits:["update:modelValue","increase","decrease"],setup(a,{emit:i}){const u=a,r=E("input-number"),l=i,v=g(!1),d=g(!1),n=O(u),t=g(0),_=g(),{disabled:R,size:T}=n,{mergedSize:f,mergedDisabled:M}=se({disabled:R,size:T});let c;const m=w(()=>{let e=n.precision.value;return(!Number.isInteger(e)||e>20)&&(e=0),e}),S=()=>u.max===1/0&&u.min===-1/0?0:u.min;let y,x;const h=e=>{if(u.disabled)return;const o=e===1?z:C;window.addEventListener("mouseup",p),y=window.setTimeout(()=>{x=window.setInterval(()=>{o()},le)},ue)},p=()=>{y&&clearTimeout(y),x&&clearInterval(x),window.removeEventListener("mouseup",p)},N=w(()=>t.value<=n.min.value),V=w(()=>t.value>=n.max.value);J(()=>{var e;t.value=((e=n.modelValue)==null?void 0:e.value)??S()});const z=()=>{if(V.value){p();return}c=F(t.value,n.step.value,m.value),t.value=c>=n.max.value?n.max.value:c,b(),l("increase")},C=()=>{if(N.value){p();return}c=F(t.value,-n.step.value,m.value),t.value=c<=n.min.value?n.min.value:c,b(),l("decrease")},U=e=>{e.key==="ArrowUp"&&z(),e.key==="ArrowDown"&&C()},Y=()=>{b()},A=()=>{d.value=!0},H=e=>{var o;t.value=e?Number((e.match(oe)??["0"])[0]):0,m.value===0?t.value=Math.trunc(t.value):t.value=ae(t.value,m.value),V.value&&(t.value=n.max.value),N.value&&(t.value=n.min.value),b(),d.value=!1,(o=_.value)==null||o.setValue(B.value)},b=()=>{l("update:modelValue",t.value)},B=w(()=>{const e=t.value.toFixed(m.value);return d.value?e:n.formatter.value(e)??e});return K(()=>u.modelValue,e=>{t.value=e??S()}),(e,o)=>(P(),j(s(ne),ee({ref_key:"inputRef",ref:_,"model-value":B.value,disabled:s(M),size:s(f),class:s(r)()},e.$attrs,{onFocus:A,onChange:Y,onBlur:H,onHoverin:o[2]||(o[2]=k=>v.value=!0),onHoverout:o[3]||(o[3]=k=>v.value=!1),onKeydown:U}),{suffix:D(()=>[q(G("div",{class:Q([s(r)("buttons"),s(r)([s(f)])])},[I(s($),{disabled:V.value,size:s(f),type:"secondary",onClick:z,onMousedown:o[0]||(o[0]=k=>h(1))},{default:D(()=>[I(s(W))]),_:1},8,["disabled","size"]),I(s($),{disabled:N.value,size:s(f),type:"secondary",onClick:C,onMousedown:o[1]||(o[1]=k=>h(0))},{default:D(()=>[I(s(X))]),_:1},8,["disabled","size"])],2),[[Z,e.controls&&!s(M)&&v.value]])]),_:1},16,["model-value","disabled","size","class"]))}}),re=te(ie),ve=re;export{ve as _};
