import{r as _,c as m,dT as j,dU as $,d as G,dS as q,e5 as F,dC as ee,eK as R,o as g,f as X,i as f,w as x,dF as H,b as w,n as v,dx as s,dG as S,e as c,et as te,g as k,F as A,eL as oe,ef as se,dX as ne,dY as ae,eM as le,eN as re,t as D,dJ as ie,dK as ce,e8 as ue,ez as de,dH as M,e1 as ve,h as pe,D as fe,dL as Z}from"./index-da6cc329.js";import{_ as me}from"./index-7e1704c8.js";const ge=(n,t)=>{const e={};for(const o of t)o in n&&n[o]&&(e[o]=n[o]);return e},K=n=>{if(n===void 0)return;if(typeof n=="string"&&/^\d+(%)$/.test(n))return n;const t=parseInt(n,10);return typeof t=="number"?`${t}px`:void 0},be=n=>(n*100).toFixed(0)+"%",ye=n=>n?typeof n=="string"?document.querySelector(n):n:document.body,_e={mounted(n,t){const e=new IntersectionObserver(o=>{o[0].isIntersecting?t.value(!0):t.value(!1)});e.observe(n),n._observer=e},unmounted(n){n._observer&&(n._observer.disconnect(),delete n._observer)}},he=n=>{const t=_(n||"beforeLoad"),e=m(()=>t.value==="beforeLoad"),o=m(()=>t.value==="loading"),r=m(()=>t.value==="error"),l=m(()=>t.value==="loaded");return{status:t,isBeforeLoad:e,isLoading:o,isError:r,isLoaded:l,setLoadStatus:u=>{t.value=u}}},Ce=he,ke=n=>{const{imageEl:t,scale:e}=j(n),o=_([0,0]);let r=!1,l,u,p=0,i=0;const b=d=>{r=!0,d.preventDefault&&d.preventDefault(),l=d.clientX,u=d.clientY,document.addEventListener("mousemove",y),document.addEventListener("mouseup",C)},y=d=>{if(r===!1)return;d.preventDefault&&d.preventDefault();const a=(d.clientX-l)/e.value+p,L=(d.clientY-u)/e.value+i;o.value=[a,L]},C=d=>{r!==!1&&(d.preventDefault&&d.preventDefault(),r=!1,p=o.value[0],i=o.value[1],document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",C))};return $(t,()=>{t.value.addEventListener("mousedown",b)}),{translate:o,resetTranslate:()=>{p=0,i=0,o.value=[p,i]}}},we=n=>{const{wrapperEl:t}=j(n),e=.1,o=.1,r=10,l=_(1),u=(i="zoomIn",b=e)=>{const y=i==="zoomIn"?b:-b;l.value+=y,l.value=Math.min(Math.max(l.value,o),r)},p=i=>{i.deltaY>0?u("zoomOut",.5):i.deltaY<0&&u("zoomIn",.5)};return $(t,()=>{t.value&&t.value.addEventListener("wheel",p)}),{scale:l,adjustZoom:u,resetScale:()=>{l.value=1}}},Ie=["src"],V=90,J=G({name:"YkImagePreview",__name:"preview",props:{visible:{type:Boolean},src:{},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},previewGroup:{type:Boolean,default:!1},popupContainer:{},unmountOnClose:{type:Boolean,default:!1},onCancel:{}},emits:["update:visible","onNext","onPrev"],setup(n,{emit:t}){const e=n,o=q("image-preview"),r=_(e.visible),l=_(0),u=_(),p=_(),{scale:i,resetScale:b,adjustZoom:y}=we(F({wrapperEl:p})),{translate:C,resetTranslate:d}=ke(F({imageEl:u,scale:i})),a=_();ee(()=>a.value=ye(e.popupContainer));const L=m(()=>a.value===document.body),E=m(()=>({...L.value?{zIndex:R.nextIndex()}:{zIndex:"inherit",position:"absolute",height:"100%"}}));$(()=>e.visible,h=>{!h&&e.unmountOnClose?r.value=!1:r.value=!0,a.value&&(h?a.value.style.overflow="hidden":a.value.style.overflow="")});const O=()=>{var h;t("update:visible",!1),(h=e.onCancel)==null||h.call(e)},z=h=>{e.maskClosable&&h.target===h.currentTarget&&O()},N=()=>{l.value=l.value===0?360-V:l.value-V},I=()=>{l.value=(l.value+V)%360},P=()=>{y("zoomIn")},T=()=>{y("zoomOut")},W=()=>{b(),d()};return(h,Y)=>{const B=me;return g(),X(ue,{to:a.value,disabled:!a.value},[f(ce,{name:"preview-fade"},{default:x(()=>[r.value?H((g(),w("div",{key:0,ref_key:"wrapperRef",ref:p,class:v(s(o)()),style:S(E.value)},[c("div",{class:v(s(o)("mask")),onClick:z},null,2),c("div",{class:v(s(o)("body")),style:S({transform:`scale(${s(i)}, ${s(i)})`}),onClick:z},[c("img",{ref_key:"imageRef",ref:u,src:e.src,class:v(s(o)("img")),style:S({transform:`rotate(${l.value}deg) translate(${s(C)[0]}px, ${s(C)[1]}px)`})},null,14,Ie)],6),e.closable?(g(),w("button",{key:0,class:v(s(o)("close-btn")),onClick:O},[f(s(te))],2)):k("",!0),e.previewGroup?(g(),w(A,{key:1},[c("button",{class:v(s(o)("arrow-left")),style:S({zIndex:s(R).nextIndex()}),onClick:Y[0]||(Y[0]=Q=>t("onPrev"))},[f(s(oe))],6),c("button",{class:v(s(o)("arrow-right")),style:S({zIndex:s(R).nextIndex()}),onClick:Y[1]||(Y[1]=Q=>t("onNext"))},[f(s(se))],6)],64)):k("",!0),c("div",{class:v(s(o)("toolbar")),style:S({zIndex:s(R).nextIndex()})},[f(B,{placement:"top",title:"向左旋转","close-delay":0},{default:x(()=>[c("button",{class:v(s(o)("toolbar-btn")),onClick:N},[f(s(ne))],2)]),_:1}),f(B,{placement:"top",title:"向右旋转","close-delay":0},{default:x(()=>[c("button",{class:v(s(o)("toolbar-btn")),onClick:I},[f(s(ae))],2)]),_:1}),f(B,{placement:"top",title:"放大","close-delay":0},{default:x(()=>[c("button",{class:v(s(o)("toolbar-btn")),onClick:P},[f(s(le))],2)]),_:1}),f(B,{placement:"top",title:"缩小","close-delay":0},{default:x(()=>[c("button",{class:v(s(o)("toolbar-btn")),onClick:T},[f(s(re))],2)]),_:1}),f(B,{placement:"top",title:"原始比例","close-delay":0},{default:x(()=>[c("button",{class:v(s(o)("toolbar-btn")),style:{width:"50px"},onClick:W},[c("span",null,D(s(be)(s(i))),1)],2)]),_:1})],6)],6)),[[ie,e.visible]]):k("",!0)]),_:1})],8,["to","disabled"])}}});const Le=["src"],xe={class:"icon"},Se={key:0,class:"alt"},Ee={class:"title"},Oe={class:"description"},$e=G({name:"YkImage",__name:"image",props:{src:{},width:{},height:{},title:{},alt:{},description:{},footerPosition:{default:"inner"},isLazy:{type:Boolean,default:!1},fit:{},preview:{type:Boolean,default:!0},popupContainer:{},onCancel:{}},setup(n){const t=n,e=q("image"),o=_(!1),r=_(),{isLoaded:l,isError:u,isLoading:p,setLoadStatus:i}=Ce(),b=m(()=>[e(),{[`${e("with-error")}`]:u.value,[`${e("with-loading")}`]:p.value}]),y=m(()=>[e("footer",[t.footerPosition])]),C=m(()=>ge(t,["width","height","title","alt"])),d=m(()=>t.fit?{objectFit:t.fit}:{}),a=m(()=>({width:K(t.width),height:L.value?void 0:K(t.height)})),L=m(()=>t.title||t.description);$(()=>t.src,()=>i("loading"));const E=I=>{t.isLazy?!r.value&&I&&(r.value=t.src):r.value=t.src},O=()=>i("loaded"),z=()=>i("error"),N=()=>{t.preview&&(o.value=!0)};return(I,P)=>H((g(),w("div",{class:v(b.value),style:S(a.value)},[c("img",de({class:s(e)("img"),style:d.value,src:r.value},C.value,{onLoad:O,onError:z,onClick:N}),null,16,Le),s(l)?k("",!0):(g(),w("div",{key:0,class:v(s(e)("overlay-container"))},[s(u)?M(I.$slots,"error",{key:0},()=>[c("div",{class:v(s(e)("overlay",["error"]))},[c("div",xe,[M(I.$slots,"error-icon",{},()=>[f(s(ve))])]),t.alt?(g(),w("div",Se,D(t.alt),1)):k("",!0)],2)]):k("",!0),s(p)?M(I.$slots,"loading",{key:1},()=>[c("div",{class:v(s(e)("overlay",["loading"]))},null,2)]):k("",!0)],2)),L.value?(g(),w("div",{key:1,class:v(y.value)},[c("div",null,[c("div",Ee,D(t.title),1),c("div",Oe,D(t.description),1)]),c("div",null,[M(I.$slots,"extra")])],2)):k("",!0),f(J,{visible:o.value,"onUpdate:visible":P[0]||(P[0]=T=>o.value=T),src:t.src,"popup-container":t.popupContainer,onCancel:t.onCancel},null,8,["visible","src","popup-container","onCancel"])],6)),[[s(_e),E]])}}),U=(n,t,e)=>{const o=_(n);return n!==void 0?o.value=n:o.value=t,[o,l=>{o.value=l,e==null||e(l)}]},Be=G({name:"YkImageGroup",__name:"preview-group",props:{visible:{type:Boolean},current:{default:0},srcList:{},width:{},height:{},defaultCurrent:{default:0},isRender:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},fit:{},onCancel:{}},emits:["update:visible","update:current"],setup(n,{emit:t}){const e=n,[o,r]=U(e.defaultCurrent,e.current,a=>t("update:current",a)),[l,u]=U(e.visible,!1,a=>t("update:visible",a)),p=m(()=>{var a;return(a=e.srcList)==null?void 0:a.length}),i=m(()=>{if(e.srcList&&e.srcList.length)return e.srcList[o.value]});$(()=>e.visible,a=>u(a)),$(()=>e.current,a=>r(a));const b=a=>{r(a),u(!0)},y=()=>{var a;u(!1),(a=e.onCancel)==null||a.call(e)},C=()=>{p.value&&(o.value>=p.value-1?o.value=0:o.value++)},d=()=>{p.value&&(o.value<=0?o.value=p.value-1:o.value--)};return(a,L)=>(g(),w(A,null,[e.isRender?(g(),X(s(fe),{key:0},{default:x(()=>[(g(!0),w(A,null,pe(e.srcList,(E,O)=>(g(),X(s(ze),{key:E,src:E,width:e.width,height:e.height,preview:!1,fit:e.fit,onClick:()=>b(O)},null,8,["src","width","height","fit","onClick"]))),128))]),_:1})):k("",!0),f(s(Pe),{visible:s(l),src:i.value,closable:e.closable,"mask-closable":e.maskClosable,"preview-group":"",onOnNext:C,onOnPrev:d,onCancel:y},null,8,["visible","src","closable","mask-closable"])],64))}}),ze=Z($e),Pe=Z(J),Me=Z(Be);export{Me as Y,ze as a,Pe as b};
