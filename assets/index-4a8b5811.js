import{d as M,dS as z,ee as N,o as f,b as K,f as I,dy as Z,dx as v,n as E,c as S,ep as L,ew as se,ex as ae,ey as le,i as F,dV as oe,g as V,e as G,t as de,w as W,dH as re,ez as ee,eA as ce,dK as ie,p as te,a as ue,F as j,h as A,eB as J,dT as pe,en as fe,dU as P,eC as R,dC as Q,r as ye,e5 as he,eD as ve,e7 as ke,eE as me,dL as ge}from"./index-2e6203f3.js";import{Y as Ke}from"./index-2aa44a00.js";const D=Symbol("TreeInjectionKey"),q=Symbol("TreeNodeInjectionKey"),_e=M({__name:"node-switcher",setup(i){const d=z("tree-node-switcher"),t=N(q),n=N(D);return(e,c)=>{var u,w,m,_;return f(),K("span",{class:E(v(d)([(u=v(t))!=null&&u.expanded.value?"rotate":"",(w=v(t))!=null&&w.isLeaf?"leaf":""])),onClick:c[0]||(c[0]=$=>{var T,C,l,r;return(r=(T=v(n))==null?void 0:T.onExpand)==null?void 0:r.call(T,(C=v(t))==null?void 0:C.option.key,(l=v(t))==null?void 0:l.expanded.value)})},[(f(),I(Z((_=(m=v(n))==null?void 0:m.expandIcon)==null?void 0:_.call(m))))],2)}}});function Y(i){var t;let d=[];return(t=i.children)==null||t.forEach(n=>{d.push(n.key),n.children&&n.children.length>0&&(d=d.concat(Y(n)))}),d}const be=M({__name:"tree-node",props:{label:{},node:{}},setup(i){const d=z("tree-node"),t=i,n=S(()=>d()),e=N(D),c=N(q),u=S(()=>{var l;return!!((l=e==null?void 0:e.selectedKeys)!=null&&l.includes(t.node.key))}),w=S(()=>d("content",[e!=null&&e.blockNode?"block":void 0,u.value?"active":void 0])),m=Object.assign({fold:()=>L(se),unfold:()=>L(ae),file:()=>L(le)},e==null?void 0:e.fileIcons,t.node.icons),_=S(()=>e!=null&&e.fileTree?c!=null&&c.isLeaf?m.file:c!=null&&c.expanded.value?m.unfold:m.fold:null),$=l=>{var y,h,k,b;let r=[t.node.key];if(!(e!=null&&e.checkStrictly)){const g=(y=e==null?void 0:e.nodeMaps)==null?void 0:y.get(t.node.key);if(g&&g.pKey){const p=(h=e==null?void 0:e.nodeMaps)==null?void 0:h.get(g.pKey);p&&((k=p.children)!=null&&k.every(H=>{var O,s;return(s=(O=e==null?void 0:e.checkedKeys)==null?void 0:O.concat([t.node.key]))==null?void 0:s.includes(H.key)}))&&r.push(p.key)}r.push(...Y(t.node))}(b=e==null?void 0:e.onChecked)==null||b.call(e,r,l)},T=S(()=>{var l,r;return e!=null&&e.checkStrictly?!1:((l=t.node.children)==null?void 0:l.some(y=>{var h;return(h=e==null?void 0:e.checkedKeys)==null?void 0:h.includes(y.key)}))&&!((r=t.node.children)!=null&&r.every(y=>{var h;return(h=e==null?void 0:e.checkedKeys)==null?void 0:h.includes(y.key)}))}),C=S(()=>{var l,r,y;return e!=null&&e.checkStrictly?(l=e==null?void 0:e.checkedKeys)==null?void 0:l.includes(t.node.key):((r=e==null?void 0:e.checkedKeys)==null?void 0:r.includes(t.node.key))||((y=t.node.children)==null?void 0:y.every(h=>{var k;return(k=e==null?void 0:e.checkedKeys)==null?void 0:k.includes(h.key)}))});return(l,r)=>{var y,h;return f(),K("div",{class:E(n.value)},[F(_e),(y=v(e))!=null&&y.checkable?(f(),K("span",{key:0,class:E(v(d)("checkbox")),onClick:r[0]||(r[0]=oe(()=>{},["stop"]))},[F(v(Ke),{checked:C.value,indeterminate:T.value,onChange:$},null,8,["checked","indeterminate"])],2)):V("",!0),G("div",{class:E(w.value),onClick:r[1]||(r[1]=k=>{var b,g;return(g=(b=v(e))==null?void 0:b.onSelect)==null?void 0:g.call(b,t.node.key)})},[(h=v(e))!=null&&h.fileTree?(f(),K("span",{key:0,class:E(v(d)("file"))},[(f(),I(Z(_.value)))],2)):V("",!0),G("span",null,de(l.label),1)],2)],2)}}}),Se=M({__name:"expand-transition",setup(i){const d=z("collapse"),t=e=>{e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},n={beforeEnter(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){e.dataset.oldOverflow=e.style.overflow,e.scrollHeight!==0?e.style.maxHeight=`${e.scrollHeight}px`:e.style.maxHeight=0,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom,e.style.overflow="hidden"},afterEnter(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow},enterCancelled(e){t(e)},beforeLeave(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow="hidden"},leave(e){e.scrollHeight!==0&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){t(e)},leaveCancelled(e){t(e)}};return(e,c)=>(f(),I(ie,ee({name:v(d)()},ce(n)),{default:W(()=>[re(e.$slots,"default")]),_:3},16,["name"]))}}),we={key:0,class:"yk-tree__list"},X=M({__name:"node",props:{option:{}},setup(i){const d=i,t=N(D),n=S(()=>{var u;return!!((u=t==null?void 0:t.expandedKeys)!=null&&u.includes(d.option.key))}),e=S(()=>n.value&&!c.value),c=S(()=>!d.option.children||!d.option.children.length);return te(q,{option:d.option,isLeaf:c.value,expanded:n}),(u,w)=>{const m=ue("node",!0);return f(),K(j,null,[F(be,{label:u.option.label,node:u.option},null,8,["label","node"]),F(Se,null,{default:W(()=>[e.value?(f(),K("div",we,[(f(!0),K(j,null,A(u.option.children,_=>(f(),I(m,{key:_.key,option:_},null,8,["option"]))),128))])):V("",!0)]),_:1})],64)}}}),U=(i,d)=>{const t=new Map;return i&&i.length===0||i==null||i.forEach(n=>{t.set(n.key,{...n,pKey:d});for(const[e,c]of U(n.children,n.key))t.set(e,c)}),t},Te=M({name:"YkTree",__name:"tree",props:J({options:{},blockNode:{type:Boolean,default:!1},defaultExpandedKeys:{default(){return[]}},expandedKeys:{},selectedKeys:{},defaultSelectedKeys:{default(){return[]}},multiple:{type:Boolean,default:!1},expandIcon:{type:Function,default(){return L(me)}},fileTree:{type:Boolean,default:!1},fileIcons:{},checkable:{type:Boolean,default:!1},checkedKeys:{},checkStrategy:{default:"all"},checkStrictly:{type:Boolean,default:!1},scrollbar:{default:!1},unSelectKey:{}},{expandedKeys:{local:!0,default:[]},selectedKeys:{local:!0,default:[]},checkedKeys:{default:[],local:!0}}),emits:J(["expand","select","check"],["update:expandedKeys","update:selectedKeys","update:checkedKeys"]),setup(i,{emit:d}){const t=z("tree"),n=i,e=d,{checkStrictly:c,checkStrategy:u,checkable:w,fileIcons:m,fileTree:_,blockNode:$,expandIcon:T,unSelectKey:C}=pe(n),l=fe(U(n.options));P(()=>n.options,()=>{l.value=U(n.options)});const r=R(i,"expandedKeys",{local:!0}),y=s=>{var a;h(s,!1,!0);const o=(a=l.value.get(s))==null?void 0:a.pKey;o&&y(o)};Q(()=>{if(n.defaultExpandedKeys.length!==0)for(const s of n.defaultExpandedKeys)y(s)});const h=(s,o=!1,a=!1)=>{const B=new Set([...r.value]);o?B.delete(s):B.add(s),r.value=[...B],!a&&e("expand",r.value)},k=R(i,"selectedKeys",{local:!0});Q(()=>{var s;if(n.defaultSelectedKeys.length!==0){k.value=n.defaultSelectedKeys;for(const o of n.defaultSelectedKeys){const a=(s=l.value.get(o))==null?void 0:s.pKey;a&&y(a)}}});const b=s=>{n.multiple?k.value=[...new Set([...k.value,s])]:k.value=[s],e("select",k.value)};P(()=>C==null?void 0:C.value,s=>{k.value=k.value.filter(o=>o!=s),w.value&&O([s],!1)});const g=R(i,"checkedKeys",{local:!0}),p=ye([]);p.value=[...g.value],P(c,s=>{if(s)H();else{let o=[];p.value.forEach(a=>{const B=l.value.get(a);if(!B)return;const ne=Y(B);o.push(a),ne.forEach(x=>{o.includes(x)||o.push(x)})}),p.value=[...new Set(o)]}},{immediate:!0});const H=()=>{if(u.value==="all"||c.value){g.value=[...p.value];return}const s=[];p.value.forEach(o=>{if(!l.value.has(o))return;const a=Y(l.value.get(o));if(a&&a.length>0&&a.every(B=>p.value.includes(B))){s.push(o);return}}),u.value==="parent"&&(g.value=p.value.filter(o=>{const a=l.value.get(o);return!(a&&a.pKey&&s.includes(a.pKey))})),u.value==="child"&&(g.value=p.value.filter(o=>!s.includes(o)))};P(p,H,{deep:!0,immediate:!0}),P(u,H);const O=(s,o)=>{o?p.value.push(...s):p.value=p.value.filter(a=>!s.includes(a))};return te(D,he({blockNode:$,expandedKeys:r,selectedKeys:k,checkedKeys:p,fileTree:_,fileIcons:m,checkable:w,checkStrategy:u,checkStrictly:c,expandIcon:T,nodeMaps:l,onSelect:b,onExpand:h,onChecked:O})),(s,o)=>(f(),K("div",{class:E(v(t)())},[n.scrollbar?(f(),I(v(ke),ve(ee({key:0},n.scrollbar)),{default:W(()=>[(f(!0),K(j,null,A(s.options,a=>(f(),I(X,{key:a.key,option:a},null,8,["option"]))),128))]),_:1},16)):(f(!0),K(j,{key:1},A(s.options,a=>(f(),I(X,{key:a.key,option:a},null,8,["option"]))),128))],2))}}),Ce=ge(Te),Ee=Ce;export{Ce as Y,Ee as _};
