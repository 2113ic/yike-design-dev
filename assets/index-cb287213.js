import{d as P,dS as Y,ee as O,o as f,b as _,f as I,dy as X,dx as y,n as E,c as S,ep as $,ew as ne,ex as ae,ey as se,i as L,dV as le,g as R,e as x,t as oe,w as U,dH as de,ez as Z,eA as re,dK as ce,p as ee,a as ie,F,h as V,eB as G,dT as ue,en as pe,dU as H,eC as D,dC as J,r as fe,e5 as ye,eD as he,e7 as ve,eE as ke,dL as me}from"./index-3f20ccf0.js";import{Y as ge}from"./index-3377dbe6.js";const z=Symbol("TreeInjectionKey"),W=Symbol("TreeNodeInjectionKey"),Ke=P({__name:"node-switcher",setup(p){const n=Y("tree-node-switcher"),t=O(W),d=O(z);return(e,r)=>{var v,C,m,b;return f(),_("span",{class:E(y(n)([(v=y(t))!=null&&v.expanded.value?"rotate":"",(C=y(t))!=null&&C.isLeaf?"leaf":""])),onClick:r[0]||(r[0]=N=>{var K,k,i,c;return(c=(K=y(d))==null?void 0:K.onExpand)==null?void 0:c.call(K,(k=y(t))==null?void 0:k.option.key,(i=y(t))==null?void 0:i.expanded.value)})},[(f(),I(X((b=(m=y(d))==null?void 0:m.expandIcon)==null?void 0:b.call(m))))],2)}}});function j(p){var t;let n=[];return(t=p.children)==null||t.forEach(d=>{n.push(d.key),d.children&&d.children.length>0&&(n=n.concat(j(d)))}),n}const _e=P({__name:"tree-node",props:{label:{},node:{}},setup(p){const n=p,t=Y("tree-node"),d=S(()=>t()),e=O(z),r=O(W),v=S(()=>{var i;return!!((i=e==null?void 0:e.selectedKeys)!=null&&i.includes(n.node.key))}),C=S(()=>t("content",[e!=null&&e.blockNode?"block":void 0,v.value?"active":void 0])),m=Object.assign({fold:()=>$(ne),unfold:()=>$(ae),file:()=>$(se)},e==null?void 0:e.fileIcons,n.node.icons),b=S(()=>e!=null&&e.fileTree?r!=null&&r.isLeaf?m.file:r!=null&&r.expanded.value?m.unfold:m.fold:null),N=i=>{var h,o,w,g;let c=[n.node.key];if(!(e!=null&&e.checkStrictly)){const u=(h=e==null?void 0:e.nodeMaps)==null?void 0:h.get(n.node.key);if(u&&u.pKey){const B=(o=e==null?void 0:e.nodeMaps)==null?void 0:o.get(u.pKey);B&&((w=B.children)!=null&&w.every(M=>{var a,s;return(s=(a=e==null?void 0:e.checkedKeys)==null?void 0:a.concat([n.node.key]))==null?void 0:s.includes(M.key)}))&&c.push(B.key)}c.push(...j(n.node))}(g=e==null?void 0:e.onChecked)==null||g.call(e,c,i)},K=S(()=>{var i,c;return e!=null&&e.checkStrictly?!1:((i=n.node.children)==null?void 0:i.some(h=>{var o;return(o=e==null?void 0:e.checkedKeys)==null?void 0:o.includes(h.key)}))&&!((c=n.node.children)!=null&&c.every(h=>{var o;return(o=e==null?void 0:e.checkedKeys)==null?void 0:o.includes(h.key)}))}),k=S(()=>{var i,c,h;return e!=null&&e.checkStrictly?(i=e==null?void 0:e.checkedKeys)==null?void 0:i.includes(n.node.key):((c=e==null?void 0:e.checkedKeys)==null?void 0:c.includes(n.node.key))||((h=n.node.children)==null?void 0:h.every(o=>{var w;return(w=e==null?void 0:e.checkedKeys)==null?void 0:w.includes(o.key)}))});return(i,c)=>{var h,o;return f(),_("div",{class:E(d.value)},[L(Ke),(h=y(e))!=null&&h.checkable?(f(),_("span",{key:0,class:E(y(t)("checkbox")),onClick:c[0]||(c[0]=le(()=>{},["stop"]))},[L(y(ge),{checked:k.value,indeterminate:K.value,onChange:N},null,8,["checked","indeterminate"])],2)):R("",!0),x("div",{class:E(C.value),onClick:c[1]||(c[1]=w=>{var g,u;return(u=(g=y(e))==null?void 0:g.onSelect)==null?void 0:u.call(g,n.node.key)})},[(o=y(e))!=null&&o.fileTree?(f(),_("span",{key:0,class:E(y(t)("file"))},[(f(),I(X(b.value)))],2)):R("",!0),x("span",null,oe(i.label),1)],2)],2)}}}),be=P({__name:"expand-transition",setup(p){const n=Y("collapse"),t=e=>{e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},d={beforeEnter(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){e.dataset.oldOverflow=e.style.overflow,e.scrollHeight!==0?e.style.maxHeight=`${e.scrollHeight}px`:e.style.maxHeight=0,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom,e.style.overflow="hidden"},afterEnter(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow},enterCancelled(e){t(e)},beforeLeave(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow="hidden"},leave(e){e.scrollHeight!==0&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){t(e)},leaveCancelled(e){t(e)}};return(e,r)=>(f(),I(ce,Z({name:y(n)()},re(d)),{default:U(()=>[de(e.$slots,"default")]),_:3},16,["name"]))}}),Se={key:0,class:"yk-tree__list"},Q=P({__name:"node",props:{option:{}},setup(p){const n=p,t=O(z),d=S(()=>{var v;return!!((v=t==null?void 0:t.expandedKeys)!=null&&v.includes(n.option.key))}),e=S(()=>d.value&&!r.value),r=S(()=>!n.option.children||!n.option.children.length);return ee(W,{option:n.option,isLeaf:r.value,expanded:d}),(v,C)=>{const m=ie("node",!0);return f(),_(F,null,[L(_e,{label:v.option.label,node:v.option},null,8,["label","node"]),L(be,null,{default:U(()=>[e.value?(f(),_("div",Se,[(f(!0),_(F,null,V(v.option.children,b=>(f(),I(m,{key:b.key,option:b},null,8,["option"]))),128))])):R("",!0)]),_:1})],64)}}}),A=(p,n)=>{const t=new Map;return p&&p.length===0||p==null||p.forEach(d=>{t.set(d.key,{...d,pKey:n});for(const[e,r]of A(d.children,d.key))t.set(e,r)}),t},we=P({name:"YkTree",__name:"tree",props:G({options:{},blockNode:{type:Boolean,default:!1},defaultExpandedKeys:{default(){return[]}},expandedKeys:{},selectedKeys:{},defaultSelectedKeys:{default(){return[]}},multiple:{type:Boolean,default:!1},expandIcon:{type:Function,default(){return $(ke)}},fileTree:{type:Boolean,default:!1},fileIcons:{},checkable:{type:Boolean,default:!1},checkedKeys:{},checkStrategy:{default:"all"},checkStrictly:{type:Boolean,default:!1},scrollbar:{default:!1},unSelectKey:{}},{expandedKeys:{local:!0,default:[]},selectedKeys:{local:!0,default:[]},checkedKeys:{default:[],local:!0}}),emits:G(["expand","select","check"],["update:expandedKeys","update:selectedKeys","update:checkedKeys"]),setup(p,{emit:n}){const t=p,d=Y("tree"),{checkStrictly:e,checkStrategy:r,checkable:v,fileIcons:C,fileTree:m,blockNode:b,expandIcon:N,unSelectKey:K}=ue(t),k=pe(A(t.options));H(()=>t.options,()=>{k.value=A(t.options)});const i=D(p,"expandedKeys",{local:!0}),c=a=>{var l;h(a,!1,!0);const s=(l=k.value.get(a))==null?void 0:l.pKey;s&&c(s)};J(()=>{if(t.defaultExpandedKeys.length!==0)for(const a of t.defaultExpandedKeys)c(a)});const h=(a,s=!1,l=!1)=>{const T=new Set([...i.value]);s?T.delete(a):T.add(a),i.value=[...T],!l&&n("expand",i.value)},o=D(p,"selectedKeys",{local:!0});J(()=>{var a;if(t.defaultSelectedKeys.length!==0){o.value=t.defaultSelectedKeys;for(const s of t.defaultSelectedKeys){const l=(a=k.value.get(s))==null?void 0:a.pKey;l&&c(l)}}});const w=a=>{t.multiple?o.value=[...new Set([...o.value,a])]:o.value=[a],n("select",o.value)};H(()=>K==null?void 0:K.value,a=>{o.value=o.value.filter(s=>s!=a),v.value&&M([a],!1)});const g=D(p,"checkedKeys",{local:!0}),u=fe([]);u.value=[...g.value],H(e,a=>{if(a)B();else{let s=[];u.value.forEach(l=>{const T=k.value.get(l);if(!T)return;const te=j(T);s.push(l),te.forEach(q=>{s.includes(q)||s.push(q)})}),u.value=[...new Set(s)]}},{immediate:!0});const B=()=>{if(r.value==="all"||e.value){g.value=[...u.value];return}const a=[];u.value.forEach(s=>{if(!k.value.has(s))return;const l=j(k.value.get(s));if(l&&l.length>0&&l.every(T=>u.value.includes(T))){a.push(s);return}}),r.value==="parent"&&(g.value=u.value.filter(s=>{const l=k.value.get(s);return!(l&&l.pKey&&a.includes(l.pKey))})),r.value==="child"&&(g.value=u.value.filter(s=>!a.includes(s)))};H(u,B,{deep:!0,immediate:!0}),H(r,B);const M=(a,s)=>{s?u.value.push(...a):u.value=u.value.filter(l=>!a.includes(l))};return ee(z,ye({blockNode:b,expandedKeys:i,selectedKeys:o,checkedKeys:u,fileTree:m,fileIcons:C,checkable:v,checkStrategy:r,checkStrictly:e,expandIcon:N,nodeMaps:k,onSelect:w,onExpand:h,onChecked:M})),(a,s)=>(f(),_("div",{class:E(y(d)())},[t.scrollbar?(f(),I(y(ve),he(Z({key:0},t.scrollbar)),{default:U(()=>[(f(!0),_(F,null,V(a.options,l=>(f(),I(Q,{key:l.key,option:l},null,8,["option"]))),128))]),_:1},16)):(f(!0),_(F,{key:1},V(a.options,l=>(f(),I(Q,{key:l.key,option:l},null,8,["option"]))),128))],2))}}),Te=me(we),Ie=Te;export{Te as Y,Ie as _};
