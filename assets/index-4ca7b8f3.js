import{d as F,dJ as H,r as k,dZ as R,dK as U,c as A,dM as E,dL as K,o as O,f as j,w as C,ea as J,j as P,n as Z,dw as n,e as p,_ as N,eU as q,eT as G,ec as Q,ey as W,d_ as X}from"./index-ac581855.js";import{Y as ee}from"./index-a473c536.js";import{u as te}from"./use-form-item-6ddf7526.js";const h=(u,l,a)=>{if(Number.isInteger(u)&&Number.isInteger(l)){const r=u+l;if(a===0)return r}const d=u.toString().split(".")[1]??"",c=l.toString().split(".")[1]??"";let o=Math.max(d.length,c.length);o>a&&(o=a);const s=10**o;return(u*s+l*s)/s},se=/[-]?(\d*\.\d+|\d+\.\d|\d+)/,ne=250,ae=60,oe=F({name:"YkInputNumber",__name:"input-number",props:{modelValue:{},max:{default:1/0},min:{default:-1/0},step:{default:1},precision:{default:0},size:{default:"l"},disabled:{type:Boolean,default:!1},message:{},controls:{type:Boolean,default:!0},formatter:{}},emits:["update:modelValue","increase","decrease"],setup(u,{emit:l}){const a=u,d=H("input-number"),c=k(!1),o=R({isMax:!1,isMin:!1}),s=U(a),t=k(0),r=k(""),{disabled:B,size:S}=s,{mergedSize:m,mergedDisabled:z}=te({disabled:B,size:S}),v=A(()=>{let e=s.precision.value;return(!Number.isInteger(e)||e>20)&&(e=0),e}),_=()=>a.max===1/0&&a.min===-1/0?0:a.min,b=()=>(+t.value).toFixed(v.value);let w,g;const D=e=>{if(a.disabled)return;const i=e===1?y:M;window.addEventListener("mouseup",f),w=window.setTimeout(()=>{g=window.setInterval(()=>{i()},ae)},ne)},f=()=>{w&&clearTimeout(w),g&&clearInterval(g),window.removeEventListener("mouseup",f)},I=()=>{o.isMax=t.value>=s.max.value,o.isMin=t.value<=s.min.value};E(()=>{var e;t.value=((e=s.modelValue)==null?void 0:e.value)??_(),I(),a.modelValue&&(r.value=b())});const y=()=>{if(t.value>=s.max.value){f();return}t.value=h(t.value,s.step.value,v.value),x(),l("increase")},M=()=>{if(t.value<=s.min.value){f();return}t.value=h(t.value,-s.step.value,v.value),x(),l("decrease")},$=e=>{e.key==="ArrowUp"&&y(),e.key==="ArrowDown"&&M()},L=e=>{t.value=e?Number((e.match(se)??["0"])[0]):0,v.value===0&&(t.value=Math.trunc(t.value)),I()},T=()=>{},Y=()=>{o.isMax&&(t.value=s.max.value),o.isMin&&(t.value=s.min.value),x()},x=()=>{I(),r.value=b(),l("update:modelValue",t.value)};return K(()=>a.modelValue,e=>{t.value=e??_(),r.value=b()}),(e,i)=>(O(),j(n(ee),W({"model-value":r.value,disabled:n(z),size:n(m),class:n(d)()},e.$attrs,{onFocus:T,onChange:L,onBlur:Y,onHoverin:i[2]||(i[2]=V=>c.value=!0),onHoverout:i[3]||(i[3]=V=>c.value=!1),onKeydown:$}),{suffix:C(()=>[J(P("div",{class:Z([n(d)("buttons"),n(d)([n(m)])])},[p(n(N),{disabled:o.isMax,size:n(m),type:"secondary",onClick:y,onMousedown:i[0]||(i[0]=V=>D(1))},{default:C(()=>[p(n(q))]),_:1},8,["disabled","size"]),p(n(N),{disabled:o.isMin,size:n(m),type:"secondary",onClick:M,onMousedown:i[1]||(i[1]=V=>D(0))},{default:C(()=>[p(n(G))]),_:1},8,["disabled","size"])],2),[[Q,e.controls&&!n(z)&&c.value]])]),_:1},16,["model-value","disabled","size","class"]))}}),ie=X(oe),de=ie;export{de as _};
